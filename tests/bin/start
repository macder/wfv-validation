#!/bin/bash

## ----------------------------------
# Step #1: Define variables
# ----------------------------------

RED='\033[0;41;30m'
STD='\033[0;0;39m'

declare DATABASE=(
  "wordpress_test" # DB Name
  "root"           # DB User
  "root"           # DB Pass
  "localhost"      # DB Host
)

WORDPRESS="latest" # WordPress Version

declare SSH_TUNNEL=(
  "5555"           # Local Inbound Port
  "127.0.0.1"      # Localhost IP
  "3306"           # Local Outbound Port
  "vagrant"        # Remote User
  "192.168.33.10"  # Remote Host
)

declare MENU_MAIN=(
  "MAIN MENU"
  "Database Settings"
  "SSH Tunnel For Remote DB"
  "WordPress Version"
  "Run Tests"
)

declare MENU_DATABASE=(
  "DATABASE"
  "NAME: "${DATABASE[0]}
  "USER: "${DATABASE[1]}
  "PASS: "${DATABASE[2]}

)

declare MENU_SSH_TUNNEL=(
  "SSH TUNNEL"
  "Inbound Port: "${SSH_TUNNEL[0]}
  "Localhost IP: "${SSH_TUNNEL[1]}
  "Remote User: "${SSH_TUNNEL[2]}
  "Remote Host: "${SSH_TUNNEL[3]}
)

declare MENU_WORDPRESS=(
  "WORDPRESS VERSION"
  "$WORDPRESS"
  "Other"
)

declare MENU_TESTS=(
  "UNIT TESTS"
  "ALL"
  "Input"
  "Form"
  "Errors"
  "Messages"
  "Validator"
)

# read input from the keyboard, store it in 'choice'
read_options(){
  items_in_menu=$(($1+1))
  read -p "Enter choice [ 1 - $items_in_menu ] " choice

}

menu_main() {
  CURRENT_MENU=("${MENU_MAIN[@]}")
  show_menu CURRENT_MENU
  read_options $item_count

  case $choice in
    1) menu_database ;;
    2) menu_ssh ;;
    3) menu_wordpress ;;
    4) menu_tests ;;
    5) exit 0 ;;
    *) echo -e "${RED}void choice${STD}" && sleep 0.1
  esac
}


menu_database() {
  CURRENT_MENU=("${MENU_DATABASE[@]}")
  show_menu CURRENT_MENU
  read_options $item_count
}

menu_ssh() {
  CURRENT_MENU=("${MENU_SSH_TUNNEL[@]}")
  show_menu CURRENT_MENU
  read_options $item_count
}

menu_wordpress() {
  CURRENT_MENU=("${MENU_WORDPRESS[@]}")
  show_menu CURRENT_MENU
  read_options $item_count
}

menu_tests() {
  CURRENT_MENU=("${MENU_TESTS[@]}")
  show_menu CURRENT_MENU
  read_options $item_count
}

# function to display menus
show_menu() {
  local -n MENU_ITEMS="$1"

  clear
  echo "--------------------------------"
  echo " W F V   U N I T  T E S T I N G "
  echo "--------------------------------"
  echo " ${MENU_ITEMS[0]}"
  echo "--------------------------------"
  echo ""

  MENU_NAME=${MENU_ITEMS[0]}
  unset MENU_ITEMS[0]

  for index in "${!MENU_ITEMS[@]}" ; do
    echo "  $index. ${MENU_ITEMS[index]}"
  done

  echo "  $((index+1)). Exit"
  echo ""
  item_count=$index

}



MENU_NAME=("MAIN MENU")
while true
do
  case $MENU_NAME in
    "MAIN MENU") menu_main ;;
    "DATABASE") menu_database ;;
    "SSH TUNNEL") menu_ssh ;;
    "UNIT TESTS") menu_tests ;;
  esac

  #CURRENT_MENU=("${MENU_MAIN[@]}")
  # show_menu CURRENT_MENU # MENU_SSH_TUNNEL MENU_DATABASE MENU_MAIN MENU_WP_VER

done
